#!/usr/bin/env node
var cli = require('meow')([
  'Usage:',
  '  ... | tap-speck',
  '',
  'Options:',
  '  -m, --min        minimal mode',
  '      --no-color   boring mode',
  '',
  'Other options:',
  '  -h, --help       show usage information',
  '  -v, --version    print version info and exit'
].join('\n'), {
  boolean: ['help', 'version', 'min'],
  alias: {
    h: 'help', v: 'version', m: 'min'
  }
})

var tapSpec = require('../')
var options = {}

var stream = tapSpec(cli.flags)

process.stdin
  .pipe(stream)
  .pipe(process.stdout)

process.on('exit', function (status) {
  if (status === 1) {
    process.exit(1)
  }

  if (stream.failed) {
    process.exit(1)
  }
})
